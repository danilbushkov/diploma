%! TEX TS-program = xelatex

\documentclass[a4paper,10pt]{article}


\usepackage[english, russian]{babel}
\usepackage{fontspec}
\usepackage{fancyhdr}
\usepackage[top = 5mm, left = 20mm, right = 5mm, bottom = 15mm]{geometry}
\usepackage{ifthen}
\usepackage{graphicx}
\usepackage{tabularray}
\UseTblrLibrary{counter}
\UseTblrLibrary{functional}

\input{../frames.tex}
\input{../note/constants.example.tex}

% Убираем линию у верхнего колонтитула
\renewcommand{\headrulewidth}{0pt}

% Определяем стиль главной рамки
\fancypagestyle{mainframe} {
    \fancyhf{}
    \fancyhead[L]{
        \mainframe[
            tpga=\tpga,
            departmentandgroup=\departmentandgroupinframe,
            topic=\topic,
            creator=\authorinframe,
            inspector=\inspectorinframe,
            norminspector=\norminspectorinframe,
            approver=\approverinframe,
            page=\thepage,
            total=1
        ]
    }
}

\pagestyle{mainframe}

\setmainfont{Arial}

\setlength{\parindent}{0cm}


\newcounter{rnum}
\setcounter{rnum}{0}
\newcommand{\printrownum}{\stepcounter{rnum}\thernum}

% Начало документа
\begin{document}
\large


\begin{filecontents}{content.tex}
	&   &  &  &  &  & \\
	&   &  & Документация общая &  &  & \\
	&   &  & Вновь разработанная &  &  & \\
	&   &  &  &  &  & \\
	&   &  & Пояснительная записка & 15 &  & \\
	&   &  &  &  &  & \\
	&   &  & Графическая часть &  &  & \\
	&   &  & Вновь разработанная &  &  & \\
	&   &  & Cхемы алгоритмов & 2 &  & Плакат \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
	&   &  &  &  &  & \\
\end{filecontents}

\begin{tblr}[evaluate=\fileInput]{
	stretch=1.5,
	width=\textwidth,
	hline{2-Y} = {1pt},
	vline{2-Y} = {1pt},
	row{1}={ht=20mm,valign=m,halign=c},
	row{2-Z}={ht=8.05mm,valign=m,halign=c},
	colspec={X[0.20]X[0.35]X[2.65]X[2.42]X[0.35]X[0.35]X[0.76]},
	cell{2-Z}{1}={appto={\printrownum}},
	}
	\rotatebox[origin=c]{90}{№ строки}                              &
	\rotatebox[origin=c]{90}{Формат}                                &
	Обозначение                                                     &
	Наименование                                                    &
	\rotatebox[origin=c]{90}{\parbox{20mm}{\centering Кол. листов}} &
	№ экз.                                                          &
	Приме\-чание
	\\

	\fileInput{content.tex}
\end{tblr}



\end{document}
